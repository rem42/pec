<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
	<title>{% block title %}Welcome!{% endblock %}</title>
    <style>
        #searchResults
        {
            display: none;
            position: absolute;
            background-color: #FFFFFF;
            border: solid 1px #9a9a9a;
            border-radius: 5px;
            padding: 10px 15px 5px 15px;
        }
    </style>
	<!-- Bootstrap core CSS -->
	<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
	<link rel="stylesheet" href="//cdn.datatables.net/plug-ins/1.10.7/integration/bootstrap/3/dataTables.bootstrap.css">
	<style>
		.row{
			margin-right: 0px;
			margin-left: 0px;
		}
	</style>
	{% block stylesheets %}{% endblock %}
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	<link rel="icon" type="image/x-icon" href="{{ asset('favicon.ico') }}" />
    {% block js %}{% endblock %}

    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->

</head>
<body>
<div class="container-fluid">
    <div class="navbar navbar-default navbar-fixed-top">
        <div class="container-fluid">
            {# Brand and toggle get grouped for better mobile display #}
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#admin-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                {% if app.user %}
                    <a class="navbar-brand" href="{{ path('timeline') }}">PEC</a>
                {% else %}
                    <a class="navbar-brand" href="{{ path('login') }}">PEC</a>
                {% endif %}

            </div>

            {# Collect the nav links, forms, and other content for toggling #}
            <div class="collapse navbar-collapse" id="admin-navbar-collapse-1">
                {{ knp_menu_render('AppBundle:Builder:mainMenu', {'currentClass': 'active', 'template': 'AppBundle:Menu:knp_menu.html.twig'}) }}
                {{ knp_menu_render('AppBundle:Builder:userMenu', {'currentClass': 'active', 'template': 'AppBundle:Menu:knp_menu.html.twig'}) }}
                <form class="navbar-form navbar-left" role="search">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search" id="search" autocomplete="off">
                    </div>
                        <div id="searchResults">
                        </div>
                </form>
            </div>
        </div>
    </div>


    <div class="content" style="margin-top: 60px;">
        {% block body %}{% endblock %}
    </div>
</div>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
<script src="//cdn.datatables.net/1.10.7/js/jquery.dataTables.min.js"></script>
<script src="//cdn.datatables.net/plug-ins/1.10.7/integration/bootstrap/3/dataTables.bootstrap.js"></script>

<script>
    $('#search').keyup(function() {
        searchText = $(this).val();

        if(searchText.length > 1)
        {
            $.ajax({
                type: "POST",
                url: "{{ path("search") }}",
                dataType: "json",
                data: {searchText : searchText},
                success : function(response)
                {
                    var text = "";
                    $(response).each(function(i) {
                       text += ("<p><a href=" + Routing.generate('profil_public', { id: response[i].id }) + ">" + response[i].name + " " + response[i].surname + "<small> (" + response[i].mail + ")</small>" + "</a></p>");
                    });

                    $("#searchResults").html(text).show();
                    //console.log(response);

                }
            });
        }
        else
        {
            var text = "";
            $("#searchResults").html(text).hide();
        }
    });
</script>
{% block javascripts %}{% endblock %}
</body>
</html>